<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <button onclick="handleClick()">btn</button>
</body>

</html>
<script>
    function getRandom() {
        return Math.floor(Math.random()*10)
    }
    function getData() {
        let random = getRandom();
        let arr = [];
        for(let i = 0; i < random; i++) {
            arr.push(i)
        }
        let p = new Promise((res,rej) => {
            setTimeout(() => {
                res({code: 200, data: arr})
            },1000)
        })
        return p;
    }
    // p.then(res =>{
    //     console.log(res)
    // })
    function handleClick() {
        getData().then(res => {
            console.log(res)
        })
    }
    
</script>
<script>
    // https://www.cnblogs.com/smile-tianxia/p/11714999.html

    /**
 * 解决两个数相加精度丢失问题
 * @param a
 * @param b
 * @returns {Number}
 */
    function floatAdd(a, b) {
        var c, d, e;
        if (undefined == a || null == a || "" == a || isNaN(a)) { a = 0; }
        if (undefined == b || null == b || "" == b || isNaN(b)) { b = 0; }
        try {
            c = a.toString().split(".")[1].length;
        } catch (f) {
            c = 0;
        }
        try {
            d = b.toString().split(".")[1].length;
        } catch (f) {
            d = 0;
        }
        e = Math.pow(10, Math.max(c, d));
        return (floatMul(a, e) + floatMul(b, e)) / e;
    }
    // console.log(floatAdd(0.1,0.2))
    /**
     * 解决两个数相减精度丢失问题
     * @param a
     * @param b
     * @returns {Number}
     */
    function floatSub(a, b) {
        var c, d, e;
        if (undefined == a || null == a || "" == a || isNaN(a)) { a = 0; }
        if (undefined == b || null == b || "" == b || isNaN(b)) { b = 0; }
        try {
            c = a.toString().split(".")[1].length;
        } catch (f) {
            c = 0;
        }
        try {
            d = b.toString().split(".")[1].length;
        } catch (f) {
            d = 0;
        }
        e = Math.pow(10, Math.max(c, d));
        return (floatMul(a, e) - floatMul(b, e)) / e;
    }
    /**
     * 解决两个数相乘精度丢失问题
     * @param a
     * @param b
     * @returns {Number}
     */
    function floatMul(a, b) {
        var c = 0,
            d = a.toString(),
            e = b.toString();
        try {
            c += d.split(".")[1].length;
        } catch (f) { }
        try {
            c += e.split(".")[1].length;
        } catch (f) { }
        return Number(d.replace(".", "")) * Number(e.replace(".", "")) / Math.pow(10, c);
    }
    console.log(floatMul("1.2","12"))
    /**
     * 解决两个数相除精度丢失问题
     * @param a
     * @param b
     * @returns
     */
    function floatDiv(a, b) {
        var c, d, e = 0,
            f = 0;
        try {
            e = a.toString().split(".")[1].length;
        } catch (g) { }
        try {
            f = b.toString().split(".")[1].length;
        } catch (g) { }
        return c = Number(a.toString().replace(".", "")), d = Number(b.toString().replace(".", "")), floatMul(c / d, Math.pow(10, f - e));
    }
    // console.log(floatAdd("3000.125", 1000))
</script>
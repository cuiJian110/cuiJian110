<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

</body>

</html>
<script>
    var library = {
        book1: {
            name: ''
        },
        book2: ''
    };
    observe(library);
    library.book1.name = 'vue权威指南';
    library.book2 = '没有此书籍';
    function defineObj(obj, key, value) {
        observe(value);
        var dep = new Dep();
        Object.defineProperty(obj, key, {
            set(newVal) {
                if (value === newVal) {
                    return;
                }
                value = newVal
                console.log('属性' + key + '已经被监听了，现在值为：“' + newVal.toString() + '”');
                dep.notify(); // 如果数据变化，通知所有订阅者
            },
            get() {
                if (true) {
                    // dep.addSub(watcher); // 在这里添加一个订阅者
                }
                return value;
            }
        })
    }
    function observe(obj) {
        if (!obj || typeof obj !== "object") {
            return;
        }
        Object.keys(obj).forEach(item => {
            defineObj(obj, item, obj[item])
        })
    }
    function Dep() {
        this.subs = [];
    }
    Dep.prototype = {
        addSub: function (sub) {
            this.subs.push(sub);
        },
        notify: function () {
            this.subs.forEach(function (sub) {
                sub.update();
            });
        }
    };
</script>
<script>
    console.log(555);
    console.log(library)
</script>
<script>
    let book = {};
    let name = "";
    Object.defineProperty(book, "name", {
        set(value) {
            name = value;
            console.log('你取了一个书名叫做' + value);
        },
        get() {
            return '《' + name + '》'
        }
    })
    book.name = "js全解"
    // let aaa = book.name
    // console.log(aaa)
    console.log(book)

</script>